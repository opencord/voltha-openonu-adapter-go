{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "7db7e42e_1567cf03",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3237,
      "author": {
        "id": 1000666
      },
      "writtenOn": "2021-10-21T15:03:16Z",
      "side": 1,
      "message": "I don\u0027t think it is required to \u0027unset\u0027 the reset bit again. The write (set) operation of the control block just resets PM data and TCA\u0027s as immediate activity",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c2283c1f_96a88918",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3237,
      "author": {
        "id": 1000726
      },
      "writtenOn": "2021-10-21T16:19:23Z",
      "side": 1,
      "message": "Yes agreed. The problem is the while doing the tests, it was found out that the counters were all 0 after the first reset on sending the traffic. So we have added this check to test once so that we can confirm whether there is some issue with device or code.",
      "parentUuid": "7db7e42e_1567cf03",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "53b605bd_7e13f0ba",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3237,
      "author": {
        "id": 1000666
      },
      "writtenOn": "2021-10-22T09:55:19Z",
      "side": 1,
      "message": "don\u0027t really understand you comment here, perhaps also see my comment below (for the expectation of pm data results)",
      "parentUuid": "c2283c1f_96a88918",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3f40ae2f_e83c2352",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3237,
      "author": {
        "id": 1000726
      },
      "writtenOn": "2021-10-22T11:24:03Z",
      "side": 1,
      "message": "There was a issue with the onu that it was not clearing the reset bit in control block on its own. As per the spec it should do so but its not doing so. so we need to unset the reset bit after reseting the counters.",
      "parentUuid": "53b605bd_7e13f0ba",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b0813e5a_9ab5c50f",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3237,
      "author": {
        "id": 1000666
      },
      "writtenOn": "2021-10-22T11:43:29Z",
      "side": 1,
      "message": "What ONU was it (vendor, type, software version)?  In this case I would prefer a ONU type specific workaround and not to apply this kind of extra effort generally. Is the supplier of the ONU informed about it? Maybe with an updated software version of this ONU the workaround can completely be removed again then. At least there should be according comments in the code.",
      "parentUuid": "3f40ae2f_e83c2352",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1b61a03b_4c10376c",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3237,
      "author": {
        "id": 1000116
      },
      "writtenOn": "2021-10-22T12:32:15Z",
      "side": 1,
      "message": "This was an alpha ONU if I\u0027m not mistaken, Girish knows more. \nI woudl agree that this is not ideal for everybody but also this is idempotent if I understand correctly, meaning that if the ONU already properly set it to 0 we just do a useless operation, which true, is costly but not an issue. \nUnless this is a major issue with all the other onus I\u0027d go for this change.",
      "parentUuid": "b0813e5a_9ab5c50f",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7ac6124e_892cd907",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3237,
      "author": {
        "id": 1000127
      },
      "writtenOn": "2021-10-25T15:25:20Z",
      "side": 1,
      "message": "This is not an Alpha ONU. It is a sercomm glasfaser onu. Yes setting back to 0 is not an expectation, but is not harm and Chip was mentioning in another channel that, and I quote him \"will make MIB auditing a bit better since it always reads back as zero and if you always write the extra zero after the reset, the OpenONU MIB and the ONU MIB have the same value.\"",
      "parentUuid": "1b61a03b_4c10376c",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "90928a03_68a6f4f7",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3303,
      "author": {
        "id": 1000666
      },
      "writtenOn": "2021-10-21T14:30:20Z",
      "side": 1,
      "message": "Wouldn\u0027t it be sufficient to check just down or up? I mean both are set one after another in above loop ...",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "89041915_17f56435",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3303,
      "author": {
        "id": 1000726
      },
      "writtenOn": "2021-10-21T16:19:23Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "90928a03_68a6f4f7",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "514e6aa0_3235f68b",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3321,
      "author": {
        "id": 1000666
      },
      "writtenOn": "2021-10-21T14:30:20Z",
      "side": 1,
      "message": "My question here is, when this is really called? For me it looks like at start of the metrics collector. So here I suppose no PmExtended object has been created so far on the ONU. Accordingly a set operation on it (as I asume to be invoked from here) would fail. So a create with reset flag would be the correct choice.\nOn the other hand I would suposse it should be possible to reset the PM data at any time on request, and not just at start (in which case a set request would be a good choice) ...\nMaybe I do not oversee this just from looking at the diffs...",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0b1f4bb8_258c0cf1",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3321,
      "author": {
        "id": 1000666
      },
      "writtenOn": "2021-10-21T15:33:44Z",
      "side": 1,
      "message": "Checked the code a bit more, so: ExtendedPm objects are created from dh.StartCollector (which is called from MibDownload event) - so they basically should exist. Compared to that the \u0027data requests\u0027 are called from openonu::GetSingleValue via dh.getOnuOMCICounters(). This one now checks existence of pOnuMetricsMgr - which does not necessarily mean that StartCollector has been called before. So during startup there might be a short time, when an external request comes in, where the ExtendedPm objects have not been created. This maybe improved a bit, but the general handling using the set-rquest for the reset bit should be ok here.",
      "parentUuid": "514e6aa0_3235f68b",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "80c63af7_ae0c7d9c",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3321,
      "author": {
        "id": 1000726
      },
      "writtenOn": "2021-10-21T16:19:23Z",
      "side": 1,
      "message": "if the extended pm me has not been created, there is a check at the beginning of CollectEthernetFrameExtendedPMCounters which will fail the request.",
      "parentUuid": "0b1f4bb8_258c0cf1",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "59f38925_46293131",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3321,
      "author": {
        "id": 1000666
      },
      "writtenOn": "2021-10-22T09:55:19Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "80c63af7_ae0c7d9c",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c895d997_54b14808",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3338,
      "author": {
        "id": 1000666
      },
      "writtenOn": "2021-10-21T15:33:44Z",
      "side": 1,
      "message": "In the end you request Pm data here immediately after the reset (if it was active before).  So you may receive some just low values, which in my point of view are not really of interest (and maybe a bit confusing).\nSo I would favour a simplified mechanism here that either does the reset (and perhaps just delivers assumed 0 values to maybe commit the protobuf response expectation [pro forma]).\nThen the operator may request the next get activity from management system at a time of his selection (without having reset bit set) and then will get all the values accumulated from the time of the reset.\nSo my approach here would be to either request the reset of PM data or the PM data from the ONU here.",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9095a259_c058f816",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3338,
      "author": {
        "id": 1000726
      },
      "writtenOn": "2021-10-21T16:19:23Z",
      "side": 1,
      "message": "Actually the reset option is in the same command as get. But the reset is optional. So we can do a get with reset flag and then we can do a get without reset as well.",
      "parentUuid": "c895d997_54b14808",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6415cfbe_e62688ad",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3338,
      "author": {
        "id": 1000666
      },
      "writtenOn": "2021-10-22T09:55:19Z",
      "side": 1,
      "message": "Yes, understand that. But the current proceeding in respect to the ONU (to my understanding) for \"get with reset-bit set\" is (by the way - a stand-alone operation on operator side for a \u0027reset-only\u0027 request would be more clear):\n- extendedPm set-request with P-Bit set\n- extendedPm set-request with P-Bit cleared (which I still would recommend to remove)\n- extendedPm get-request with some fairly undefined time between the reset and get operation -\u003e with the result on running traffic, that the counters will be quite random and do not provide any useful information\n\nSo my proposal for the \"get with reset-bit set\" operation would just be:\n- extendedPm set-request with P-Bit set\n- respond to operator with a PmData set with all counters cleared (without any get request from the ONU)\nOngoing real PM data can then be fetched by the operator according to his further \"get without reset-bit\" requests",
      "parentUuid": "9095a259_c058f816",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d87dca55_ac978d38",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3338,
      "author": {
        "id": 1000726
      },
      "writtenOn": "2021-10-22T11:24:03Z",
      "side": 1,
      "message": "Yes that would be good. Let me discuss this with others also.",
      "parentUuid": "6415cfbe_e62688ad",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d55b967b_8daad28d",
        "filename": "internal/pkg/pmmgr/onu_metrics_manager.go",
        "patchSetId": 15
      },
      "lineNbr": 3338,
      "author": {
        "id": 1000116
      },
      "writtenOn": "2021-10-22T12:32:15Z",
      "side": 1,
      "message": "I\u0027m ok with the change that Michael is suggesting.",
      "parentUuid": "d87dca55_ac978d38",
      "revId": "0251e23755e95598369f3871b556243ad48b384a",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    }
  ]
}